import sys
import hashlib
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

def crack_password(target_hash, wordlist_path, hash_type='sha256'):
    """Attempts to crack a password hash using a dictionary attack."""
    print(f"\n{Style.BRIGHT}Attempting to crack hash: {target_hash[:20]}...{Style.RESET_ALL}")
    print(f"Using wordlist: {wordlist_path}")
    print(f"Hash type: {hash_type}")

    try:
        hash_func = getattr(hashlib, hash_type)
    except AttributeError:
        print(f"{Fore.RED}Error: Invalid hash type '{hash_type}'. Supported: md5, sha1, sha256, etc.")
        return

    try:
        with open(wordlist_path, 'r', encoding='utf-8', errors='ignore') as f:
            for line in f:
                password = line.strip()
                hashed_password = hash_func(password.encode('utf-8')).hexdigest()
                
                if hashed_password == target_hash:
                    print(f"\n{Fore.GREEN}{Style.BRIGHT}[+] Password found: {password}")
                    return

        print(f"\n{Fore.RED}[-] Password not found in wordlist.")

    except FileNotFoundError:
        print(f"{Fore.RED}Error: Wordlist not found at '{wordlist_path}'")
    except Exception as e:
        print(f"{Fore.RED}An error occurred: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 4:
        print(f"{Fore.YELLOW}Usage: python {sys.argv[0]} <hash_type> <target_hash> <wordlist_path>")
        print(f"{Fore.YELLOW}Example: python {sys.argv[0]} sha256 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8 /path/to/wordlist.txt")
        sys.exit(1)

    hash_algorithm = sys.argv[1].lower()
    hash_to_crack = sys.argv[2]
    path_to_wordlist = sys.argv[3]

    crack_password(hash_to_crack, path_to_wordlist, hash_algorithm)
