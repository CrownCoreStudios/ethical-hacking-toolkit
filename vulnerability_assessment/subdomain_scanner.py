import sys
import socket
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

# A list of common subdomains to check
COMMON_SUBDOMAINS = [
    'www', 'mail', 'ftp', 'localhost', 'webmail', 'smtp', 'pop', 'ns1', 'ns2',
    'admin', 'cpanel', 'webdisk', 'autodiscover', 'm', 'dev', 'test', 'vpn',
    'blog', 'shop', 'api', 'support', 'docs', 'portal', 'remote', 'secure'
]

def scan_subdomains(domain):
    """Scans for common subdomains of a given domain."""
    print(f"\n{Style.BRIGHT}Scanning for subdomains of: {domain}{Style.RESET_ALL}\n")
    found_subdomains = []

    for sub in COMMON_SUBDOMAINS:
        full_domain = f"{sub}.{domain}"
        try:
            # Resolve the domain name to an IP address
            ip_address = socket.gethostbyname(full_domain)
            print(f"{Fore.GREEN}[+] Found: {full_domain} -> {ip_address}")
            found_subdomains.append(full_domain)
        except socket.error:
            # If it can't be resolved, the subdomain likely doesn't exist
            pass

    if not found_subdomains:
        print(f"{Fore.YELLOW}No common subdomains found.")
    else:
        print(f"\n{Style.BRIGHT}Found {len(found_subdomains)} subdomains.{Style.RESET_ALL}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"{Fore.YELLOW}Usage: python {sys.argv[0]} <domain>")
        sys.exit(1)

    target_domain = sys.argv[1]
    scan_subdomains(target_domain)
