import sys
import requests
from colorama import Fore, Style, init

# Initialize colorama
init(autoreset=True)

SECURITY_HEADERS = [
    'Strict-Transport-Security',
    'X-Frame-Options',
    'X-Content-Type-Options',
    'Content-Security-Policy',
    'Referrer-Policy',
    'Permissions-Policy'
]

def check_headers(url):
    """Checks a URL for the presence of important security headers."""
    print(f"\n{Style.BRIGHT}Checking security headers for: {url}{Style.RESET_ALL}\n")
    try:
        response = requests.get(url, timeout=5)
        headers = response.headers

        print(f"{Style.BRIGHT}--- Results ---{Style.RESET_ALL}")
        for header in SECURITY_HEADERS:
            if header in headers:
                print(f"{Fore.GREEN}[+] {header}: Present")
                # print(f"    {headers[header]}") # Uncomment to see header value
            else:
                print(f"{Fore.RED}[-] {header}: Not found")
        print(f"\n{Style.BRIGHT}----------------{Style.RESET_ALL}")

    except requests.exceptions.RequestException as e:
        print(f"{Fore.RED}Error connecting to {url}: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"{Fore.YELLOW}Usage: python {sys.argv[0]} <url>")
        sys.exit(1)

    target_url = sys.argv[1]
    if not target_url.startswith(('http://', 'https://')):
        target_url = 'https://' + target_url
    
    check_headers(target_url)
